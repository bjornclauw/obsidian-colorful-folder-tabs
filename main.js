/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => FolderColorPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  enabled: true,
  mappings: [
    // example defaults (you can remove these)
    { name: "Projects", color: "#e74c3c" },
    { name: "Design", color: "#3498db" }
  ]
};
var FolderColorPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.settings = DEFAULT_SETTINGS;
    this.observer = null;
  }
  async onload() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
    console.log("FolderColorPlugin loaded", this.settings);
    if (this.settings.enabled)
      this.addStyles();
    this.addSettingTab(new FolderColorSettingTab(this.app, this));
    this.addCommand({
      id: "toggle-folder-colors",
      name: "Toggle folder colors",
      callback: async () => {
        this.settings.enabled = !this.settings.enabled;
        await this.saveData(this.settings);
        if (this.settings.enabled)
          this.addStyles();
        else
          this.removeStyles();
      }
    });
  }
  onunload() {
    this.removeStyles();
    console.log("FolderColorPlugin unloaded");
  }
  addStyles() {
    this.applyMappingsToDOM();
    this.setupObserver();
  }
  removeStyles() {
    if (this.observer) {
      this.observer.disconnect();
      this.observer = null;
    }
    this.clearInlineMappings();
  }
  applyMappingsToDOM() {
    const mappings = this.settings.mappings || [];
    if (!mappings.length)
      return;
    const folderTitleEls = Array.from(document.querySelectorAll('.workspace-leaf-content[data-type="file-explorer"] .nav-files-container .tree-item.nav-folder .nav-folder-title'));
    folderTitleEls.forEach((titleEl) => {
      var _a;
      const text = ((_a = titleEl.textContent) == null ? void 0 : _a.trim()) || "";
      const mapping = mappings.find((m) => m.name === text);
      const folderItem = titleEl.closest(".tree-item.nav-folder");
      if (mapping && folderItem) {
        folderItem.style.setProperty("--tab-color", mapping.color);
        titleEl.style.setProperty("--tab-color", mapping.color);
      }
    });
  }
  clearInlineMappings() {
    const folderItems = Array.from(document.querySelectorAll('.workspace-leaf-content[data-type="file-explorer"] .nav-files-container .tree-item.nav-folder'));
    folderItems.forEach((el) => {
      el.style.removeProperty("--tab-color");
    });
    const titleEls = Array.from(document.querySelectorAll('.workspace-leaf-content[data-type="file-explorer"] .nav-files-container .tree-item.nav-folder .nav-folder-title'));
    titleEls.forEach((el) => el.style.removeProperty("--tab-color"));
  }
  setupObserver() {
    if (this.observer)
      return;
    const container = document.querySelector('.workspace-leaf-content[data-type="file-explorer"] .nav-files-container');
    if (!container)
      return;
    this.observer = new MutationObserver(() => {
      setTimeout(() => this.applyMappingsToDOM(), 50);
    });
    this.observer.observe(container, { childList: true, subtree: true });
  }
};
var FolderColorSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Folder Color settings" });
    new import_obsidian.Setting(containerEl).setName("Enable folder colors").setDesc("Toggle the folder color styling in the file explorer").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.enabled).onChange(async (value) => {
        this.plugin.settings.enabled = value;
        await this.plugin.saveData(this.plugin.settings);
        if (value)
          this.plugin.addStyles();
        else
          this.plugin.removeStyles();
      })
    );
    containerEl.createEl("h3", { text: "Folder \u2192 Color mappings" });
    const list = containerEl.createDiv({ cls: "folder-color-list" });
    const mappings = this.plugin.settings.mappings || [];
    mappings.forEach((m, idx) => {
      const row = list.createDiv({ cls: "folder-mapping-row" });
      row.createEl("label", { text: "Folder name", cls: "mapping-label" });
      const nameInput = row.createEl("input", { attr: { type: "text", placeholder: "Folder name", value: m.name } });
      nameInput.style.marginRight = "8px";
      nameInput.onchange = async () => {
        mappings[idx].name = nameInput.value.trim();
        await this.plugin.saveData(this.plugin.settings);
        this.plugin.addStyles();
        this.display();
      };
      row.createEl("label", { text: "Color", cls: "mapping-label" });
      const colorInput = row.createEl("input", { attr: { type: "color", value: m.color || "#ff0000" } });
      colorInput.style.marginRight = "8px";
      colorInput.onchange = async () => {
        mappings[idx].color = colorInput.value;
        await this.plugin.saveData(this.plugin.settings);
        this.plugin.addStyles();
      };
      const removeBtn = row.createEl("button", { text: "Remove" });
      removeBtn.onclick = async () => {
        mappings.splice(idx, 1);
        await this.plugin.saveData(this.plugin.settings);
        this.plugin.addStyles();
        this.display();
      };
    });
    containerEl.createEl("h4", { text: "Add mapping" });
    const addRow = containerEl.createDiv({ cls: "folder-mapping-add" });
    const newName = addRow.createEl("input", { attr: { type: "text", placeholder: "Folder name" } });
    newName.style.marginRight = "8px";
    const newColor = addRow.createEl("input", { attr: { type: "color", value: "#ff0000" } });
    newColor.style.marginRight = "8px";
    const addBtn = addRow.createEl("button", { text: "Add" });
    addBtn.onclick = async () => {
      const name = (newName.value || "").trim();
      const color = newColor.value || "#ffffff";
      if (!name)
        return;
      this.plugin.settings.mappings = this.plugin.settings.mappings || [];
      this.plugin.settings.mappings.push({ name, color });
      await this.plugin.saveData(this.plugin.settings);
      this.plugin.addStyles();
      this.display();
    };
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCAnLi9zcmMvc3R5bGVzLmNzcyc7XHJcblxyXG5cclxuaW50ZXJmYWNlIEZvbGRlck1hcHBpbmcge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgY29sb3I6IHN0cmluZzsgLy8gaGV4XHJcbn1cclxuXHJcbmludGVyZmFjZSBGb2xkZXJDb2xvclNldHRpbmdzIHtcclxuICAgIGVuYWJsZWQ6IGJvb2xlYW47XHJcbiAgICBtYXBwaW5nczogRm9sZGVyTWFwcGluZ1tdO1xyXG59XHJcblxyXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBGb2xkZXJDb2xvclNldHRpbmdzID0ge1xyXG4gICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgIG1hcHBpbmdzOiBbXHJcbiAgICAgICAgLy8gZXhhbXBsZSBkZWZhdWx0cyAoeW91IGNhbiByZW1vdmUgdGhlc2UpXHJcbiAgICAgICAgeyBuYW1lOiAnUHJvamVjdHMnLCBjb2xvcjogJyNlNzRjM2MnIH0sXHJcbiAgICAgICAgeyBuYW1lOiAnRGVzaWduJywgY29sb3I6ICcjMzQ5OGRiJyB9LFxyXG4gICAgXSxcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvbGRlckNvbG9yUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuICAgIHNldHRpbmdzOiBGb2xkZXJDb2xvclNldHRpbmdzID0gREVGQVVMVF9TRVRUSU5HUztcclxuICAgIHByaXZhdGUgb2JzZXJ2ZXI6IE11dGF0aW9uT2JzZXJ2ZXIgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgICBhc3luYyBvbmxvYWQoKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSkgYXMgRm9sZGVyQ29sb3JTZXR0aW5ncztcclxuICAgICAgICBjb25zb2xlLmxvZygnRm9sZGVyQ29sb3JQbHVnaW4gbG9hZGVkJywgdGhpcy5zZXR0aW5ncyk7XHJcblxyXG4gICAgICAgICAgICAvLyBJbmplY3Qgc3R5bGVzIGlmIGVuYWJsZWRcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlZCkgdGhpcy5hZGRTdHlsZXMoKTtcclxuXHJcbiAgICAgICAgLy8gUmVnaXN0ZXIgc2V0dGluZ3MgdGFiXHJcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBGb2xkZXJDb2xvclNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuXHJcbiAgICAgICAgLy8gQ29tbWFuZCB0byB0b2dnbGUgc3R5bGVzIHF1aWNrbHlcclxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICAgICAgICBpZDogJ3RvZ2dsZS1mb2xkZXItY29sb3JzJyxcclxuICAgICAgICAgICAgbmFtZTogJ1RvZ2dsZSBmb2xkZXIgY29sb3JzJyxcclxuICAgICAgICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuZW5hYmxlZCA9ICF0aGlzLnNldHRpbmdzLmVuYWJsZWQ7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlZCkgdGhpcy5hZGRTdHlsZXMoKTsgZWxzZSB0aGlzLnJlbW92ZVN0eWxlcygpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9udW5sb2FkKCkge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlU3R5bGVzKCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0ZvbGRlckNvbG9yUGx1Z2luIHVubG9hZGVkJyk7XHJcbiAgICB9XHJcblxyXG4gICAgICAgIGFkZFN0eWxlcygpIHtcclxuICAgICAgICAgICAgICAgIC8vIEJhc2UgQ1NTIGlzIGltcG9ydGVkIHZpYSBzaWRlLWVmZmVjdCBpbXBvcnQgJy4vc3R5bGVzLmNzcycgYW5kIHdpbGwgYmVcclxuICAgICAgICAgICAgICAgIC8vIGluamVjdGVkIGJ5IHRoZSBidW5kbGVyLiBXZSBvbmx5IG5lZWQgdG8gYXBwbHkgbWFwcGluZ3MgYW5kIG9ic2VydmVcclxuICAgICAgICAgICAgICAgIC8vIHRoZSBET00gZm9yIGR5bmFtaWMgdXBkYXRlcy5cclxuICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlNYXBwaW5nc1RvRE9NKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldHVwT2JzZXJ2ZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgcmVtb3ZlU3R5bGVzKCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5vYnNlcnZlcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9ic2VydmVyID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBSZW1vdmUgaW5saW5lIHN0eWxlcyBzZXQgYnkgbWFwcGluZ3NcclxuICAgICAgICAgICAgdGhpcy5jbGVhcklubGluZU1hcHBpbmdzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgYXBwbHlNYXBwaW5nc1RvRE9NKCkge1xyXG4gICAgICAgICAgICBjb25zdCBtYXBwaW5ncyA9IHRoaXMuc2V0dGluZ3MubWFwcGluZ3MgfHwgW107XHJcbiAgICAgICAgICAgIGlmICghbWFwcGluZ3MubGVuZ3RoKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAvLyBUaGUgZXhwbG9yZXIgcmVuZGVycyBmb2xkZXIgdGl0bGVzIGluc2lkZSBlbGVtZW50cyB3aXRoIGNsYXNzIC5uYXYtZm9sZGVyLXRpdGxlLlxyXG4gICAgICAgICAgICAvLyBXZSB3aWxsIG1hdGNoIGJ5IHRoZSB2aXNpYmxlIHRleHQgY29udGVudCAodHJpbW1lZCkuXHJcbiAgICAgICAgICAgIGNvbnN0IGZvbGRlclRpdGxlRWxzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcud29ya3NwYWNlLWxlYWYtY29udGVudFtkYXRhLXR5cGU9XCJmaWxlLWV4cGxvcmVyXCJdIC5uYXYtZmlsZXMtY29udGFpbmVyIC50cmVlLWl0ZW0ubmF2LWZvbGRlciAubmF2LWZvbGRlci10aXRsZScpKSBhcyBIVE1MRWxlbWVudFtdO1xyXG5cclxuICAgICAgICAgICAgZm9sZGVyVGl0bGVFbHMuZm9yRWFjaCh0aXRsZUVsID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSB0aXRsZUVsLnRleHRDb250ZW50Py50cmltKCkgfHwgJyc7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXBwaW5nID0gbWFwcGluZ3MuZmluZChtID0+IG0ubmFtZSA9PT0gdGV4dCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmb2xkZXJJdGVtID0gdGl0bGVFbC5jbG9zZXN0KCcudHJlZS1pdGVtLm5hdi1mb2xkZXInKSBhcyBIVE1MRWxlbWVudCB8IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpZiAobWFwcGluZyAmJiBmb2xkZXJJdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGlubGluZSBDU1MgY3VzdG9tIHByb3BlcnR5IHNvIGFsbCBydWxlcyBjYW4gcmVhZCBpdFxyXG4gICAgICAgICAgICAgICAgICAgIGZvbGRlckl0ZW0uc3R5bGUuc2V0UHJvcGVydHkoJy0tdGFiLWNvbG9yJywgbWFwcGluZy5jb2xvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVFbC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS10YWItY29sb3InLCBtYXBwaW5nLmNvbG9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGNsZWFySW5saW5lTWFwcGluZ3MoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZvbGRlckl0ZW1zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcud29ya3NwYWNlLWxlYWYtY29udGVudFtkYXRhLXR5cGU9XCJmaWxlLWV4cGxvcmVyXCJdIC5uYXYtZmlsZXMtY29udGFpbmVyIC50cmVlLWl0ZW0ubmF2LWZvbGRlcicpKSBhcyBIVE1MRWxlbWVudFtdO1xyXG4gICAgICAgICAgICBmb2xkZXJJdGVtcy5mb3JFYWNoKGVsID0+IHtcclxuICAgICAgICAgICAgICAgIGVsLnN0eWxlLnJlbW92ZVByb3BlcnR5KCctLXRhYi1jb2xvcicpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgdGl0bGVFbHMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy53b3Jrc3BhY2UtbGVhZi1jb250ZW50W2RhdGEtdHlwZT1cImZpbGUtZXhwbG9yZXJcIl0gLm5hdi1maWxlcy1jb250YWluZXIgLnRyZWUtaXRlbS5uYXYtZm9sZGVyIC5uYXYtZm9sZGVyLXRpdGxlJykpIGFzIEhUTUxFbGVtZW50W107XHJcbiAgICAgICAgICAgIHRpdGxlRWxzLmZvckVhY2goZWwgPT4gZWwuc3R5bGUucmVtb3ZlUHJvcGVydHkoJy0tdGFiLWNvbG9yJykpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzZXR1cE9ic2VydmVyKCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5vYnNlcnZlcikgcmV0dXJuO1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLWxlYWYtY29udGVudFtkYXRhLXR5cGU9XCJmaWxlLWV4cGxvcmVyXCJdIC5uYXYtZmlsZXMtY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgIGlmICghY29udGFpbmVyKSByZXR1cm47XHJcbiAgICAgICAgICAgIHRoaXMub2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBzbWFsbCBkZWJvdW5jZSB2aWEgc2V0VGltZW91dCB0byBhbGxvdyBET00gdG8gc2V0dGxlXHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuYXBwbHlNYXBwaW5nc1RvRE9NKCksIDUwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMub2JzZXJ2ZXIub2JzZXJ2ZShjb250YWluZXIsIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pO1xyXG4gICAgICAgIH1cclxufVxyXG5cclxuY2xhc3MgRm9sZGVyQ29sb3JTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgICBwbHVnaW46IEZvbGRlckNvbG9yUGx1Z2luO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEZvbGRlckNvbG9yUGx1Z2luKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgfVxyXG5cclxuICAgIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdGb2xkZXIgQ29sb3Igc2V0dGluZ3MnIH0pO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ0VuYWJsZSBmb2xkZXIgY29sb3JzJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ1RvZ2dsZSB0aGUgZm9sZGVyIGNvbG9yIHN0eWxpbmcgaW4gdGhlIGZpbGUgZXhwbG9yZXInKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PlxyXG4gICAgICAgICAgICAgICAgdG9nZ2xlLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZWQpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZWQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkgdGhpcy5wbHVnaW4uYWRkU3R5bGVzKCk7IGVsc2UgdGhpcy5wbHVnaW4ucmVtb3ZlU3R5bGVzKCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgLy8gTWFwcGluZ3MgbGlzdFxyXG4gICAgICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdGb2xkZXIgXHUyMTkyIENvbG9yIG1hcHBpbmdzJyB9KTtcclxuICAgICAgICAgICAgY29uc3QgbGlzdCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ2ZvbGRlci1jb2xvci1saXN0JyB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1hcHBpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MubWFwcGluZ3MgfHwgW107XHJcbiAgICAgICAgICAgIG1hcHBpbmdzLmZvckVhY2goKG0sIGlkeCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgcm93ID0gbGlzdC5jcmVhdGVEaXYoeyBjbHM6ICdmb2xkZXItbWFwcGluZy1yb3cnIH0pO1xyXG4gICAgICAgICAgICAgICAgcm93LmNyZWF0ZUVsKCdsYWJlbCcsIHsgdGV4dDogJ0ZvbGRlciBuYW1lJywgY2xzOiAnbWFwcGluZy1sYWJlbCcgfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lSW5wdXQgPSByb3cuY3JlYXRlRWwoJ2lucHV0JywgeyBhdHRyOiB7IHR5cGU6ICd0ZXh0JywgcGxhY2Vob2xkZXI6ICdGb2xkZXIgbmFtZScsIHZhbHVlOiBtLm5hbWUgfSB9KTtcclxuICAgICAgICAgICAgICAgIG5hbWVJbnB1dC5zdHlsZS5tYXJnaW5SaWdodCA9ICc4cHgnO1xyXG4gICAgICAgICAgICAgICAgbmFtZUlucHV0Lm9uY2hhbmdlID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hcHBpbmdzW2lkeF0ubmFtZSA9IG5hbWVJbnB1dC52YWx1ZS50cmltKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFkZFN0eWxlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByb3cuY3JlYXRlRWwoJ2xhYmVsJywgeyB0ZXh0OiAnQ29sb3InLCBjbHM6ICdtYXBwaW5nLWxhYmVsJyB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbG9ySW5wdXQgPSByb3cuY3JlYXRlRWwoJ2lucHV0JywgeyBhdHRyOiB7IHR5cGU6ICdjb2xvcicsIHZhbHVlOiBtLmNvbG9yIHx8ICcjZmYwMDAwJyB9IH0pO1xyXG4gICAgICAgICAgICAgICAgY29sb3JJbnB1dC5zdHlsZS5tYXJnaW5SaWdodCA9ICc4cHgnO1xyXG4gICAgICAgICAgICAgICAgY29sb3JJbnB1dC5vbmNoYW5nZSA9IGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBtYXBwaW5nc1tpZHhdLmNvbG9yID0gY29sb3JJbnB1dC52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uYWRkU3R5bGVzKCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlbW92ZUJ0biA9IHJvdy5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnUmVtb3ZlJyB9KTtcclxuICAgICAgICAgICAgICAgIHJlbW92ZUJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hcHBpbmdzLnNwbGljZShpZHgsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hZGRTdHlsZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gQWRkIG5ldyBtYXBwaW5nXHJcbiAgICAgICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0FkZCBtYXBwaW5nJyB9KTtcclxuICAgICAgICAgICAgY29uc3QgYWRkUm93ID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnZm9sZGVyLW1hcHBpbmctYWRkJyB9KTtcclxuICAgICAgICAgICAgY29uc3QgbmV3TmFtZSA9IGFkZFJvdy5jcmVhdGVFbCgnaW5wdXQnLCB7IGF0dHI6IHsgdHlwZTogJ3RleHQnLCBwbGFjZWhvbGRlcjogJ0ZvbGRlciBuYW1lJyB9IH0pO1xyXG4gICAgICAgICAgICBuZXdOYW1lLnN0eWxlLm1hcmdpblJpZ2h0ID0gJzhweCc7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbG9yID0gYWRkUm93LmNyZWF0ZUVsKCdpbnB1dCcsIHsgYXR0cjogeyB0eXBlOiAnY29sb3InLCB2YWx1ZTogJyNmZjAwMDAnIH0gfSk7XHJcbiAgICAgICAgICAgIG5ld0NvbG9yLnN0eWxlLm1hcmdpblJpZ2h0ID0gJzhweCc7XHJcbiAgICAgICAgICAgIGNvbnN0IGFkZEJ0biA9IGFkZFJvdy5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnQWRkJyB9KTtcclxuICAgICAgICAgICAgYWRkQnRuLm9uY2xpY2sgPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gKG5ld05hbWUudmFsdWUgfHwgJycpLnRyaW0oKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbG9yID0gbmV3Q29sb3IudmFsdWUgfHwgJyNmZmZmZmYnO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuYW1lKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXBwaW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLm1hcHBpbmdzIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubWFwcGluZ3MucHVzaCh7IG5hbWUsIGNvbG9yIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uYWRkU3R5bGVzKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgIH1cclxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBdUQ7QUFjdkQsSUFBTSxtQkFBd0M7QUFBQSxFQUMxQyxTQUFTO0FBQUEsRUFDVCxVQUFVO0FBQUE7QUFBQSxJ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
